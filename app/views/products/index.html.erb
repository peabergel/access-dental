<h1 class="text-center text-2xl mb-6">Index of products (<%= @category.name %>)</h1>
<div class="container mx-auto px-16 max-w-7xl">
  <div class="hs-accordion-group">
    <% @brands.each do |brand| %>
      <div class="hs-accordion" id="accordion-<%= brand.id %>">
        <button class="hs-accordion-toggle py-3 inline-flex items-center gap-x-3 w-full font-semibold text-start text-gray-800 hover:text-gray-500 focus:outline-none rounded-lg" aria-expanded="false" aria-controls="carousel-<%= brand.id %>">
          <span class="text-lg"><%= brand.name %></span>
        </button>
        <div id="carousel-<%= brand.id %>" class="hs-accordion-content hidden w-full overflow-hidden transition-[height] duration-300" role="region" aria-labelledby="accordion-<%= brand.id %>">
          <!-- Carousel pour chaque marque -->
          <div class="relative mb-12">
            <div data-hs-carousel='{
              "loadingClasses": "opacity-0",
              "dotsItemClasses": "hs-carousel-active:bg-blue-700 hs-carousel-active:border-blue-700 size-3 border border-gray-400 rounded-full cursor-pointer",
              "slidesQty": {
                "xs": 1,
                "lg": 3
              },
              "isDraggable": true
            }' class="relative">

              <div class="hs-carousel w-full overflow-hidden bg-white rounded-lg">
                <div class="relative h-[38rem] -mx-1">
                  <div class="hs-carousel-body absolute top-0 bottom-0 start-0 flex flex-nowrap opacity-0 cursor-grab transition-transform duration-700 hs-carousel-dragging:transition-none hs-carousel-dragging:cursor-grabbing">

                    <!-- Slide 1: Brand Card -->
                    <div class="hs-carousel-slide px-1">
                      <div class="brand_card w-full p-2 flex flex-col">
                        <div class="bg-white rounded-[2.5rem] overflow-hidden flex flex-col justify-between h-[60vh]" style="border-color: <%= brand.primary_color %>;">
                          <img src="<%= brand.image_url %>" alt="<%= brand.name %> Logo" class="w-9/12 h-50 mx-auto block object-cover">
                          <div class="p-3 h-1/6">
                            <a href="<%= brand.website_url %>" class="block w-full text-center px-4 py-2 text-white rounded-full" style="background-color: <%= brand.primary_color %>;">Visiter le site</a>
                          </div>
                        </div>
                      </div>
                    </div>

                    <!-- Slides suivantes: Product Cards -->
                    <% brand.products.each do |product| %>
                      <div class="hs-carousel-slide px-1">
                        <div class="product_card w-full p-2">
                          <div class="bg-white shadow-md rounded-[2.5rem] overflow-hidden flex flex-col h-[60vh]">
                            <img src="<%= product.image_url %>" alt="<%= product.name %>" class="w-full h-4/6 object-cover">
                            <div class="p-4 h-2/6" style="background-color: <%= brand.primary_color %>;">
                              <h3 class="text-lg font-bold"><%= product.name %></h3>
                              <p class="text-sm"><%= product.description %></p>
                              <a href="<%= product.pdf_url %>" class="mt-2 inline-block px-4 py-2 text-white rounded-full" style="background-color: <%= brand.secondary_color %>;">Plus d'infos</a>
                            </div>
                          </div>
                        </div>
                      </div>
                    <% end %>

                  </div>
                </div>
              </div>

              <!-- Boutons de navigation -->
              <button type="button" class="hs-carousel-prev hs-carousel-disabled:opacity-50 hs-carousel-disabled:pointer-events-none absolute inset-y-0 start-0 inline-flex justify-center items-center w-[46px] h-full text-gray-800 hover:bg-gray-800/10 focus:outline-none focus:bg-gray-800/10 rounded-s-lg">
                <span class="text-2xl" aria-hidden="true">
                  <svg class="shrink-0 size-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m15 18-6-6 6-6"></path>
                  </svg>
                </span>
                <span class="sr-only">Previous</span>
              </button>
              <button type="button" class="hs-carousel-next hs-carousel-disabled:opacity-50 hs-carousel-disabled:pointer-events-none absolute inset-y-0 end-0 inline-flex justify-center items-center w-[46px] h-full text-gray-800 hover:bg-gray-800/10 focus:outline-none focus:bg-gray-800/10 rounded-e-lg">
                <span class="sr-only">Next</span>
                <span class="text-2xl" aria-hidden="true">
                  <svg class="shrink-0 size-5" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m9 18 6-6-6-6"></path>
                  </svg>
                </span>
              </button>

              <!-- Pagination -->
              <div class="hs-carousel-pagination flex justify-center absolute bottom-3 start-0 end-0 space-x-2"></div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
